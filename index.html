import React, { useState, useEffect } from "react";

export default function VidaOrganizadaApp() {
  const [tela, setTela] = useState("tarefas");
  const [tarefas, setTarefas] = useState([]);
  const [novaTarefa, setNovaTarefa] = useState("");

  // ===== STORAGE HELPERS =====
  const carregar = (chave) => {
    try {
      const data = localStorage.getItem(chave);
      return data ? JSON.parse(data) : [];
    } catch {
      return [];
    }
  };

  const salvar = (chave, valor) => {
    localStorage.setItem(chave, JSON.stringify(valor));
  };

  useEffect(() => {
    setTarefas(carregar("tarefas"));
  }, []);

  useEffect(() => {
    salvar("tarefas", tarefas);
  }, [tarefas]);

  const adicionarTarefa = () => {
    if (!novaTarefa.trim()) return;
    setTarefas([...tarefas, { texto: novaTarefa, feito: false }]);
    setNovaTarefa("");
  };

  const alternarTarefa = (index) => {
    const atualizadas = [...tarefas];
    atualizadas[index].feito = !atualizadas[index].feito;
    setTarefas(atualizadas);
  };

  // ===== COMPONENTES DE TELA =====

  const TelaTarefas = () => (
    <div className="space-y-4">
      <h2 className="text-xl font-semibold">Tarefas da Casa</h2>

      <div className="flex gap-2">
        <input
          className="flex-1 p-3 rounded-xl border"
          placeholder="Adicionar tarefa..."
          value={novaTarefa}
          onChange={(e) => setNovaTarefa(e.target.value)}
        />
        <button
          onClick={adicionarTarefa}
          className="bg-black text-white px-4 rounded-xl"
        >
          +
        </button>
      </div>

      <ul className="space-y-2">
        {tarefas.map((t, i) => (
          <li
            key={i}
            onClick={() => alternarTarefa(i)}
            className={`p-3 rounded-xl shadow cursor-pointer transition ${
              t.feito ? "bg-green-100 line-through" : "bg-white"
            }`}
          >
            {t.texto}
          </li>
        ))}
      </ul>
    </div>
  );

  const TelaRotina = () => (
    <div>
      <h2 className="text-xl font-semibold">Rotina Di√°ria</h2>
      <p className="mt-2 text-gray-600">
        Aqui voc√™ poder√° organizar manh√£, tarde e noite.
      </p>
    </div>
  );

  const TelaRemedios = () => (
    <div>
      <h2 className="text-xl font-semibold">Lembretes de Rem√©dio</h2>
      <p className="mt-2 text-gray-600">
        Adicione hor√°rios para nunca esquecer.
      </p>
    </div>
  );

  const TelaConsultas = () => (
    <div>
      <h2 className="text-xl font-semibold">Consultas</h2>
      <p className="mt-2 text-gray-600">
        Controle m√©dico da fam√≠lia em um s√≥ lugar.
      </p>
    </div>
  );

  // ===== UI PREMIUM =====

  const renderTela = () => {
    switch (tela) {
      case "tarefas":
        return <TelaTarefas />;
      case "rotina":
        return <TelaRotina />;
      case "remedios":
        return <TelaRemedios />;
      case "consultas":
        return <TelaConsultas />;
      default:
        return <TelaTarefas />;
    }
  };

  const BotaoAba = ({ id, label, icon }) => (
    <button
      onClick={() => setTela(id)}
      className={`flex flex-col items-center text-xs flex-1 py-2 transition ${
        tela === id ? "text-black font-semibold" : "text-gray-400"
      }`}
    >
      <span className="text-lg">{icon}</span>
      {label}
    </button>
  );

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col items-center">
      {/* HEADER */}
      <header className="w-full max-w-md p-4 text-center">
        <h1 className="text-2xl font-bold">Vida Organizada AI</h1>
        <p className="text-sm text-gray-500">Modo Premium Ativado ‚ú®</p>
      </header>

      {/* CONTE√öDO */}
      <main className="flex-1 w-full max-w-md bg-gray-50 rounded-3xl shadow-lg p-4">
        {renderTela()}
      </main>

      {/* NAVBAR APP */}
      <nav className="w-full max-w-md bg-white border-t flex rounded-t-3xl shadow-lg">
        <BotaoAba id="tarefas" label="Tarefas" icon="üè†" />
        <BotaoAba id="rotina" label="Rotina" icon="üìÖ" />
        <BotaoAba id="remedios" label="Rem√©dios" icon="üíä" />
        <BotaoAba id="consultas" label="Consultas" icon="ü©∫" />
      </nav>
    </div>
  );
}
